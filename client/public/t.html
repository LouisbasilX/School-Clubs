<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CodeBouncer MVP</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen p-6">
  <div class="max-w-4xl mx-auto bg-white shadow-2xl rounded-2xl p-6">
    <h1 class="text-3xl font-bold mb-4 text-center text-blue-600">CodeBouncer</h1>

    <label for="code" class="block font-semibold mb-2">Paste your code here:</label>
    <textarea id="code" rows="10" class="w-full p-3 border border-gray-300 rounded-xl font-mono text-sm resize-none" placeholder="Enter your code..."></textarea>

    <div class="my-4">
      <span class="block font-semibold mb-2">Choose Your Bouncer:</span>
      <label class="inline-flex items-center mr-4">
        <input type="radio" name="mode" value="mentor" class="mr-2" checked /> Mentor Mode
      </label>
      <label class="inline-flex items-center mr-4">
        <input type="radio" name="mode" value="roast" class="mr-2" /> Roast Mode
      </label>
      <label class="inline-flex items-center">
        <input type="radio" name="mode" value="hype" class="mr-2" /> Hype Mode
      </label>
    </div>

    <button id="analyzeBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-xl w-full">Bounce My Code</button>

    <div id="response" class="mt-6 p-4 border border-gray-300 rounded-xl bg-gray-50 text-gray-800 whitespace-pre-wrap hidden"></div>
  </div>

  <script>
    const analyzeBtn = document.getElementById("analyzeBtn");
    const codeBox = document.getElementById("code");
    const responseBox = document.getElementById("response");

    analyzeBtn.addEventListener("click", async () => {
      const code = codeBox.value;
      const mode = document.querySelector('input[name="mode"]:checked').value;

      if (!code.trim()) {
        alert("Please enter some code first.");
        return;
      }

      const promptMap = {
        mentor: "Act as a friendly expert mentor. Analyze this code and give helpful suggestions:",
        roast: "Act as a sarcastic senior developer. Roast this code, but make it constructive:",
        hype: "Act as a hype man. Compliment this code and encourage the user while offering advice:"
      };

      const prompt = `${promptMap[mode]}\n\n${code}`;

      responseBox.classList.remove("hidden");
      responseBox.textContent = "Thinking...";

      try {
        const res = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer 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"
          },
          body: JSON.stringify({
            model: "gpt-4",
            messages: [
              { role: "system", content: "You are CodeBouncer, a code critic with multiple tones." },
              { role: "user", content: prompt }
            ],
            temperature: 0.7
          })
        });

        const data = await res.json();
        const message = data.choices[0].message.content;
        responseBox.textContent = message;
      } catch (err) {
        responseBox.textContent = "Something went wrong. Check your API key or internet connection.";
      }
    });
  </script>
</body>
</html>
